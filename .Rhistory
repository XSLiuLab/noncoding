ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
angle        = 0,
nudge_y = -1,
nudge_x = 1,
ylim = c(10, NA),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
angle        = 0,
nudge_y = -1,
nudge_x = 1,
ylim = c(10, NA),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
pos <- position_jitter(width = 0.3, seed = 2)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2,
position = pos) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
#segment.size = 0.2,
position = pos) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
#segment.size = 0.2,
position = pos) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
df <- data.frame(
gene = sample.int(5000),
aceth = rnorm(5000),
acvitd = rnorm(5000)
)
# New! (not available in ggplot2 version 2.2.1 or earlier)
pos <- position_jitter(width = 0.3, seed = 2)
ggplot() +
geom_jitter(
data = filter(df, acvitd > -3),
mapping = aes(x = 1, aceth),
alpha = 0.1,
colour = "#878787",
size = 2
) +
geom_jitter(
data = filter(df, acvitd <= -3),
mapping = aes(x = 1, aceth, fill = "red"),
shape = 21,
size = 2,
position = pos
) +
geom_text_repel(
data = filter(df, acvitd <= -3),
mapping = aes(x = 1, aceth, label = gene),
position = pos
)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2,
position = pos) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2,
position = pos) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
?geom_jitter
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
pos <- position_jitter(width = 0.1, seed = 2)
pos
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2, position = pos) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
?position_jitter
pos <- position_jitter(width = 0.1, height = 0.1, seed = 2)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2, position = pos) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.4) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
?geom_label_repel
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
nudge_x = 0.3,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
p1= ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggsave(filename = "pvalue_vs_count.pdf", plot = p1)
load(file = "RegionMutationList.RData")
View(prob_region_final)
library(tidyverse)
library(data.table)
library(ggrepel)
load(file = "RegionMutationList.RData")
prob_region_final[, p_value := -log10(p_val)][, p_value := ifelse(p_value > 15, 15, p_value)]
pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
p1= ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggsave(filename = "pvalue_vs_count.pdf", plot = p1, width = 5, height = 5)
ggsave(filename = "pvalue_vs_count.pdf", plot = p1, width = 7, height = 5)
p1= ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
size = 1,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggsave(filename = "pvalue_vs_count.pdf", plot = p1, width = 7, height = 5)
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
size = 3,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggsave(filename = "pvalue_vs_count.pdf", plot = p1, width = 7, height = 5)
#pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
size = 2,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
#pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
size = 2,
nudge_y = 1,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
#pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
size = 2,
nudge_y = - 1,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
#pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
size = 2,
nudge_y = -1,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
#pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
size = 2,
nudge_y = -1,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
#pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
size = 2,
nudge_y = -1,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggsave(filename = "pvalue_vs_count.pdf", plot = p1, width = 7, height = 5)
library(tidyverse)
library(data.table)
library(ggrepel)
load(file = "RegionMutationList.RData")
prob_region_final[, p_value := -log10(p_val)][, p_value := ifelse(p_value > 15, 15, p_value)]
#pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
size = 2,
nudge_y = -1,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1
#pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name)) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1
pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name), position = pos) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1
pos <- position_jitter(width = 0.3, height = 0.05, seed = 2)
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name), position = pos) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1
pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name), position = pos) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1
ggsave(filename = "pvalue_vs_count.pdf", plot = p1, width = 7, height = 5)
pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name), position = pos, size = 2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1
ggsave(filename = "pvalue_vs_count.pdf", plot = p1, width = 7, height = 5)
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos, size = 2, alpha = 0.7) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name), position = pos, size = 2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos, size = 1, alpha = 0.7) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name), position = pos, size = 2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1
ggsave(filename = "pvalue_vs_count.pdf", plot = p1, width = 7, height = 5)
pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos, size = 1, alpha = 0.7) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
nudge_y = 1,
position = pos,
size = 2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos, size = 1, alpha = 0.7) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
hjust = 1,
position = pos,
size = 2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos, size = 1, alpha = 0.7) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
hjust = 1,
position = pos,
segment.size = 2,
size = 2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1
?geom_text_repel
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos, size = 1, alpha = 0.7) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
hjust = 1,
position = pos,
segment.size = 2,
size = 2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos, size = 1, alpha = 0.7) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
hjust = 1,
position = pos,
segment.size = 0.2,
size = 2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos, size = 1, alpha = 0.7) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
hjust = 1,
position = pos,
segment.size = 0.4,
size = 2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos, size = 1, alpha = 0.7) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
hjust = 1,
position = pos,
segment.size = 0.4,min.segment.length = 0.1
size = 2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos, size = 1, alpha = 0.7) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
hjust = 1,
position = pos,
segment.size = 0.4,min.segment.length = 0.1,
size = 2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1
ggsave(filename = "pvalue_vs_count.pdf", plot = p1, width = 7, height = 5)
freq_dt = fread("final_mutation_freq.tsv.gz", header = FALSE)
library(data.table)
freq_dt = fread("final_mutation_freq.tsv.gz", header = FALSE)
a = readRDS("file = "recurrent_region.rds")
a = readRDS(file = "recurrent_region.rds")
View(a)
install.packages(c("caret", "pROC"))
