prob_region_final <- foverlaps(
prob_region,
gene_df,
type = "any"
)
prob_region_final = prob_region_final[!is.na(gene_name)][
, .(gene_name, chr, i.start, i.end, p_val, donor_list)][
order(p_val)]
prob_region_final$count = stringr::str_count(prob_region_final$donor_list, ",") + 1
prob_region_final = prob_region_final[order(count, decreasing = TRUE)]
prob_region_final
colnames(prob_region_final)[3:4] = c("start", "end")
save(prob_region_final, file = "RegionMutationList.RData")
openxlsx::write.xlsx(prob_region_final, file = "RegionMutationList.xlsx")
prob_region_final
library(tidyverse)
library(data.table)
library(ggrepel)
load(file = "RegionMutationList.RData")
prob_region_final[, p_value := -log10(p_val)][, p_value := ifelse(p_value > 15, 15, p_value)]
p1 = ggplot(prob_region_final, aes(x = count, y = p_value)) +
geom_point(color = ifelse((prob_region_final$count > 10 & prob_region_final$p_value > 5), "red",
ifelse(prob_region_final$count >= 30, "blue", "black"))) +
geom_label_repel(data = dplyr::filter(prob_region_final, (count > 10 & p_value > 5) | count >= 30 ),
aes(label = gene_name),
angle        = 0,
#vjust        = 1,
#hjust = 1,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1
ggplot(prob_region_final, aes(x = count, y = p_value)) +
geom_point(color = ifelse((prob_region_final$count > 10 & prob_region_final$p_value > 5), "red",
ifelse(prob_region_final$count >= 30, "blue", "black")))
ggplot(prob_region_final, aes(x = count, y = p_value)) +
geom_jitter(color = ifelse((prob_region_final$count > 10 & prob_region_final$p_value > 5), "red",
ifelse(prob_region_final$count >= 30, "blue", "black")))
prob_region_final
prob_region
final_dt
summary(final_dt$prob)
final_dt[, N =.N, by=region_range]
final_dt[, .(N =.N), by=region_range]
prob_region = final_dt[, .(prob = mean(prob) * width),
by = .(donor, region_range)][,
.(p_val = 1 - poibin::ppoibin(.N - 1, prob),
donor_list = paste(unique(donor), collapse = ","),
count = .N),
by = region_range
]
prob_region
summary(prob_region$count)
prob_region = final_dt[, .(prob = mean(prob) * width),
by = .(donor, region_range)][,
.(p_val = 1 - poibin::ppoibin(.N - 1, prob),
mutation_list = paste(unique(mut_index), collapse = ","),
donor_list = paste(unique(donor), collapse = ","),
count = .N),
by = region_range
]
final_dt
prob_region = final_dt[, .(prob = mean(prob) * width),
by = .(donor, region_range)][,
.(p_val = 1 - poibin::ppoibin(.N - 1, prob),
donor_list = paste(unique(donor), collapse = ","),
count = .N),
by = region_range
]
## Set 0 to minimal p value
prob_region[, p_val := ifelse(p_val < .Machine$double.xmin,
.Machine$double.xmin,
p_val)]
prob_region = prob_region[order(p_val)]
prob_region
prob_region = tidyr::separate(prob_region, col = "region_range", into = c("chr", "start", "end"))
prob_region = as.data.table(prob_region)
prob_region$start = as.integer(prob_region$start)
prob_region$end = as.integer(prob_region$end)
prob_region_final <- foverlaps(
prob_region,
gene_df,
type = "any"
)
prob_region_final = prob_region_final[!is.na(gene_name)][
, .(gene_name, chr, i.start, i.end, p_val, donor_list)][
order(p_val)]
prob_region_final = prob_region_final[order(count, decreasing = TRUE)]
prob_region_final
prob_region_final <- foverlaps(
prob_region,
gene_df,
type = "any"
)
prob_region_final
, .(gene_name, chr, i.start, i.end, p_val, donor_list, count)][
prob_region_final = prob_region_final[!is.na(gene_name)][
, .(gene_name, chr, i.start, i.end, p_val, donor_list, count)][
order(p_val)]
prob_region_final = prob_region_final[order(count, decreasing = TRUE)]
colnames(prob_region_final)[3:4] = c("start", "end")
prob_region_final
View(prob_region_final)
save(prob_region_final, file = "RegionMutationList.RData")
openxlsx::write.xlsx(prob_region_final, file = "RegionMutationList.xlsx")
prob_region_final[, p_value := -log10(p_val)][, p_value := ifelse(p_value > 15, 15, p_value)]
p1 = ggplot(prob_region_final, aes(x = count, y = p_value)) +
geom_jitter(color = ifelse((prob_region_final$count > 10 & prob_region_final$p_value > 5), "red",
ifelse(prob_region_final$count >= 30, "blue", "black"))) +
geom_label_repel(data = dplyr::filter(prob_region_final, (count > 10 & p_value > 5) | count >= 30 ),
aes(label = gene_name),
angle        = 0,
#vjust        = 1,
#hjust = 1,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1
ggplot(prob_region_final, aes(x = count, y = p_value)) +
geom_jitter()
p1 = ggplot(prob_region_final, aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 ),
aes(label = gene_name),
angle        = 0,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
p1
prob_region_final
ggsave(filename = "pvalue_vs_count.pdf", plot = p1)
ggplot(prob_region_final, aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 ),
aes(label = gene_name),
angle        = 0,
ylim = c(10, NA),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final, aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 ),
aes(label = gene_name),
angle        = 0,
nudge_y = 1,
ylim = c(10, NA),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final, aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 ),
aes(label = gene_name),
angle        = 0,
nudge_y = 0,
ylim = c(10, NA),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final, aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 ),
aes(label = gene_name),
angle        = 0,
nudge_y = -1,
ylim = c(10, NA),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final, aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 ),
aes(label = gene_name),
angle        = 0,
nudge_y = -1,
nudge_x = 1,
ylim = c(10, NA),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
angle        = 0,
nudge_y = -1,
nudge_x = 1,
ylim = c(10, NA),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
angle        = 0,
nudge_y = -1,
nudge_x = 1,
ylim = c(10, NA),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
pos <- position_jitter(width = 0.3, seed = 2)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2,
position = pos) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
#segment.size = 0.2,
position = pos) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
#segment.size = 0.2,
position = pos) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
df <- data.frame(
gene = sample.int(5000),
aceth = rnorm(5000),
acvitd = rnorm(5000)
)
# New! (not available in ggplot2 version 2.2.1 or earlier)
pos <- position_jitter(width = 0.3, seed = 2)
ggplot() +
geom_jitter(
data = filter(df, acvitd > -3),
mapping = aes(x = 1, aceth),
alpha = 0.1,
colour = "#878787",
size = 2
) +
geom_jitter(
data = filter(df, acvitd <= -3),
mapping = aes(x = 1, aceth, fill = "red"),
shape = 21,
size = 2,
position = pos
) +
geom_text_repel(
data = filter(df, acvitd <= -3),
mapping = aes(x = 1, aceth, label = gene),
position = pos
)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2,
position = pos) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2,
position = pos) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"),
position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
?geom_jitter
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count >= 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
pos <- position_jitter(width = 0.1, seed = 2)
pos
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2, position = pos) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
?position_jitter
pos <- position_jitter(width = 0.1, height = 0.1, seed = 2)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
segment.size = 0.2, position = pos) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.4) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_text_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
?geom_label_repel
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
nudge_x = 0.3,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
p1= ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggsave(filename = "pvalue_vs_count.pdf", plot = p1)
load(file = "RegionMutationList.RData")
View(prob_region_final)
library(tidyverse)
library(data.table)
library(ggrepel)
load(file = "RegionMutationList.RData")
prob_region_final[, p_value := -log10(p_val)][, p_value := ifelse(p_value > 15, 15, p_value)]
pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
p1= ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggsave(filename = "pvalue_vs_count.pdf", plot = p1, width = 5, height = 5)
ggsave(filename = "pvalue_vs_count.pdf", plot = p1, width = 7, height = 5)
p1= ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
size = 1,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggsave(filename = "pvalue_vs_count.pdf", plot = p1, width = 7, height = 5)
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black"), position = pos) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
position = pos,
aes(label = gene_name),
size = 3,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggsave(filename = "pvalue_vs_count.pdf", plot = p1, width = 7, height = 5)
#pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
size = 2,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
#pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
size = 2,
nudge_y = 1,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
#pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
size = 2,
nudge_y = - 1,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
#pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_jitter(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
size = 2,
nudge_y = -1,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
#pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
size = 2,
nudge_y = -1,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
#pos <- position_jitter(width = 0.2, height = 0.03, seed = 2)
p1 = ggplot(prob_region_final[gene_name != "BCL2"], aes(x = count, y = p_value)) +
geom_point(color = ifelse(prob_region_final[gene_name != "BCL2"]$count > 20, "red", "black")) +
geom_label_repel(data = dplyr::filter(prob_region_final, count > 20 & gene_name != "BCL2"),
aes(label = gene_name),
size = 2,
nudge_y = -1,
segment.size = 0.2) +
labs(x = "Number of samples with base mutated", y = "-log10 P value") +
cowplot::theme_cowplot(rel_small = 1.5)
ggsave(filename = "pvalue_vs_count.pdf", plot = p1, width = 7, height = 5)
